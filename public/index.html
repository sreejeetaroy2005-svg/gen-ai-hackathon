<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>AI Marketplace Assistant</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>âœ¨ AI Marketplace Assistant</h1>
    <form id="form" enctype="multipart/form-data">
      <input placeholder="Product Title" id="title" name="title" />
<input placeholder="Craft (e.g., weaving, pottery)" id="craft" name="craft" />
<input placeholder="Materials" id="materials" name="materials" />
<input placeholder="Region (e.g., Odisha, Rajasthan)" id="region" name="region" />
<textarea placeholder="Extra Notes" id="notes" name="notes"></textarea>


      <label for="language">Output Language:</label>
      <select id="language" name="language">
        <option value="English" selected>English</option>
        <option value="Hindi">Hindi</option>
        <option value="Bengali">Bengali</option>
        <option value="Tamil">Tamil</option>
        <option value="Telugu">Telugu</option>
        <option value="Marathi">Marathi</option>
      </select>

      <label for="image">Upload Product Image:</label>
      <input type="file" id="image" name="image" accept="image/*" />

      <img id="preview" style="max-width:200px; margin-top:10px; display:none;" />
      <p id="image-status" style="display:none; color: #007bff; font-weight: 600;"></p>

      <button type="submit">ðŸš€ Generate Content</button>
    </form>

    <h2>AI Output:</h2>
    <div id="output-box"></div>
    <button id="copy-btn" class="copy-btn" style="display:none;">ðŸ“‹ Copy to Clipboard</button>
  </div>

  <script>
    const form = document.getElementById("form");
    const outputBox = document.getElementById("output-box");
    const imageInput = document.getElementById("image");
    const preview = document.getElementById("preview");
    const copyBtn = document.getElementById("copy-btn");
    const imageStatus = document.getElementById("image-status");

    // Preview uploaded image + show status
    imageInput.addEventListener("change", () => {
      const file = imageInput.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          preview.src = e.target.result;
          preview.style.display = "block";
          imageStatus.textContent = "ðŸ–¼ï¸ Image will be analyzed by AI";
          imageStatus.style.display = "block";
        };
        reader.readAsDataURL(file);
      } else {
        preview.style.display = "none";
        imageStatus.style.display = "none";
      }
    });

    // Submit form
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      outputBox.textContent = "â³ Generating...";

      const formData = new FormData();
      formData.append("title", document.getElementById("title").value);
      formData.append("craft", document.getElementById("craft").value);
      formData.append("materials", document.getElementById("materials").value);
      formData.append("region", document.getElementById("region").value);
      formData.append("notes", document.getElementById("notes").value);
      formData.append("language", document.getElementById("language").value);
      if (imageInput.files[0]) {
        formData.append("image", imageInput.files[0]);
      }

      try {
        const resp = await fetch("/api/generate", {
          method: "POST",
          body: formData,
        });

        if (!resp.ok) {
          const text = await resp.text();
          outputBox.textContent = "âŒ Server error: " + text;
          return;
        }

        let data;
        try {
          data = await resp.json();
          outputBox.textContent = data.output || data.error;
        } catch (err) {
          const raw = await resp.text();
          outputBox.textContent = "âš ï¸ Could not parse JSON.\nRaw output:\n" + raw;
        }

        // Show copy button if we have output
        copyBtn.style.display = "inline-block";
      } catch (err) {
        outputBox.textContent = "âŒ Network error: " + err.message;
      }
    });

    // Copy to clipboard
    copyBtn.addEventListener("click", () => {
      navigator.clipboard.writeText(outputBox.textContent).then(() => {
        copyBtn.textContent = "âœ… Copied!";
        setTimeout(() => (copyBtn.textContent = "ðŸ“‹ Copy to Clipboard"), 2000);
      });
    });
  </script>
  <div class="slideshow">
  <img src="bg1.jpg" class="active" />
  <img src="bg2.jpg" />
  <img src="bg3.jpg" />
  <img src="bg4.jpg" />
  <img src="bg5.jpg" />
</div>

<script>
  const slides = document.querySelectorAll(".slideshow img");
  let index = 0;

  setInterval(() => {
    slides[index].classList.remove("active");
    index = (index + 1) % slides.length;
    slides[index].classList.add("active");
  }, 5000); // change every 5s
</script>

</body>
</html>

